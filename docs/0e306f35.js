import{_ as w,A as P,aL as c,aM as _,az as g,aP as L,b as m,d as r,e as i,p as d,h as a,w as v,l as f,F as b,E as S,f as x,t as V,n as C}from"./assets/index-26dd84fe.js";/* empty css        *//* empty css        */import{a as B,E as N}from"./bf0fe6cf.js";const T={components:{AsyncButtom:P,ElTimePicker:B,ElInputNumber:N},props:{modelValue:{type:String,default:()=>"00:00:00.0"},sourcePath:{type:String,default:()=>""},sourceKeyname:{type:String,default:()=>""}},emits:["update:modelValue"],data(){return{images:[],timeControllers:[{label:"-1m",value:-60},{label:"-10s",value:-10},{label:"-1s",value:-1},{label:"+1s",value:1},{label:"+10s",value:10},{label:"+1m",value:60}]}},methods:{updateTimestring(l){this.$emit("update:modelValue",`${c(_(this.modelValue.split(".")[0])+l)}.${this.modelValue.split(".")[1]}`)},async refreshScreenshots(l){if(!this.sourcePath&&!this.sourceKeyname){this.$msgBox.warning("请先选择视频源");return}for(const o of this.images)o.originSrc&&URL.revokeObjectURL(o.originSrc),URL.revokeObjectURL(o.src);this.images=[{ts:this.modelValue,src:await this.getScreenshots(this.modelValue,l)}];const t=_(this.modelValue),s=c(g.subtract(t,.1),!0);this.images.unshift({ts:s,src:await this.getScreenshots(s,l)});for(const o in new Array(3).fill(null)){const n=c(g.add(t,(Number(o)+1)*.1),!0);this.images.push({ts:n,src:await this.getScreenshots(n,l)})}},getScreenshots(l,t){return L({sourcePath:this.sourcePath,sourceKeyname:this.sourceKeyname,timestamps:l,format:t}).then(s=>URL.createObjectURL(s))}}},U={class:"preview-screenshots"},R={class:"screenshots-box"},A={class:"btn-box"},E={class:"image-box"},I={class:"ts"},j=["src","onClick"];function z(l,t,s,o,n,u){const y=m("el-time-picker"),k=m("el-input-number"),h=m("AsyncButtom");return r(),i("div",U,[d(y,{"model-value":s.modelValue.split(".")[0],"value-format":"HH:mm:ss",format:"HH:mm:ss",style:{width:"120px"},"onUpdate:modelValue":t[0]||(t[0]=e=>{l.$emit("update:modelValue",`${e||"00:00:00"}.${s.modelValue.split(".")[1]}`)})},null,8,["model-value"]),t[3]||(t[3]=a("span",null,".",-1)),d(k,{"model-value":Number("0."+(s.modelValue.split(".")[1]||"0")),min:0,max:1,precision:3,step:.1,style:{width:"120px"},"onUpdate:modelValue":t[1]||(t[1]=e=>{l.$emit("update:modelValue",`${s.modelValue.split(".")[0]}.${String(e).split(".")[1]||0}`)})},null,8,["model-value"]),d(h,{type:"primary",size:"mini",onLoadingClick:()=>u.refreshScreenshots("jpg")},{default:v(()=>t[2]||(t[2]=[f(" 获取截图 ")])),_:1},8,["onLoadingClick"]),a("div",R,[a("div",A,[(r(!0),i(b,null,S(n.timeControllers,e=>(r(),x(h,{key:e.label,size:"mini",onLoadingClick:()=>{u.updateTimestring(e.value)}},{default:v(()=>[f(V(e.label),1)]),_:2},1032,["onLoadingClick"]))),128))]),a("div",E,[(r(!0),i(b,null,S(n.images,e=>(r(),i("div",{key:e.src,class:C(["item-box",{active:e.ts===s.modelValue}])},[a("div",I,V(e.ts),1),a("img",{class:"image",src:e.src,onClick:()=>{e.ts===s.modelValue?l.$imagePreview(()=>e.originSrc?e.originSrc:u.getScreenshots(e.ts,"png").then(p=>(e.originSrc=p,p)),{fileName:s.sourcePath.slice(s.sourcePath.lastIndexOf("/")+1).split(".")[0]}):l.$emit("update:modelValue",e.ts)}},null,8,j)],2))),128))])])])}const F=w(T,[["render",z],["__scopeId","data-v-90a835a7"]]);export{F as P};

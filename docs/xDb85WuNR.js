import{_ as k,L as y,K as L,c as N,r as w,ai as H,aj as b,k as d,b as r,l as B,p as C,f as h,g as x,n as E,j as T}from"./assets/index-BCg_aInO.js";const I={components:{LoadingIcon:y},props:{hasNext:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},onLoadingClick:{type:Function,required:!0}},setup(l,{emit:a}){const{computedHasNext:c,computedLoading:e}=L(l,a),i=N(()=>!l.hasNext||e.value),u=()=>{if(!i.value)try{e.value=!0;const t=l.onLoadingClick(e.value);t instanceof Promise?t.then(n=>{typeof(n==null?void 0:n.hasNext)=="boolean"&&(c.value=n.hasNext)}).finally(()=>{e.value=!1}):(typeof(t==null?void 0:t.hasNext)=="boolean"&&(c.value=t.hasNext),e.value=!1)}catch(t){console.error(t),e.value=!1}},o=w(30);let s=null;const m=t=>{if(i.value)return;const{scrollTop:n,clientHeight:g,scrollHeight:_}=document.documentElement;if(t>0&&Math.abs(_-(n+g))<60){if(o.value--,o.value===0){o.value=30,u();return}s&&clearTimeout(s),s=setTimeout(()=>{o.value=30},500)}},p=t=>{m(t.deltaY)};let f=null;const v=t=>{if(t.touches.length===1){const n=t.touches[0];if(!f){f=n.pageY;return}m((n.pageY-f)/5)}};return H(()=>{window.addEventListener("wheel",p),window.addEventListener("touchmove",v)}),b(()=>{window.removeEventListener("wheel",p),window.addEventListener("touchmove",v)}),{computedLoading:e,nextOffset:o,clickHandler:u,disabled:i}}},O={key:0,class:"loading"},Y={key:1},V={key:2};function j(l,a,c,e,i,u){const o=T("LoadingIcon");return d(),r("div",{class:E(["next-button",{disabled:e.disabled,loading:e.computedLoading}]),onClick:a[0]||(a[0]=(...s)=>e.clickHandler&&e.clickHandler(...s))},[e.computedLoading?(d(),r("span",O,[a[1]||(a[1]=B(" 加载中 ")),C(o)])):c.hasNext?(d(),r("span",Y,"下滑加载更多")):(d(),r("span",V,"没有更多")),h("div",{class:"next-mask",style:x({top:`${e.nextOffset}px`})},[h("span",{class:"next-mask-text",style:x({top:`-${e.nextOffset}px`})}," 下滑加载更多 ",4)],4)],2)}const M=k(I,[["render",j],["__scopeId","data-v-aa7a48e4"]]);export{M as N};

import{_,L as w,j as o,k as d,d as s,aT as V,w as i,f,z as c,e as h,l as x,t as p,aU as F}from"./assets/index-CulBNc66.js";const v={components:{LoadingIcon:w},props:{modelValue:{type:[String,Array],default:void 0},disabled:{type:Boolean,default:()=>!1},checkMode:{type:String,default:()=>""}},emits:["update:modelValue"],data(){return{loading:!1,useFileFilter:!0,tableData:[],currentPath:"/"}},computed:{filterTableData(){return this.tableData.filter(e=>this.fileFilter&&this.useFileFilter&&e.type==="file"?this.fileFilter(e):!0)}},watch:{modelValue:{immediate:!0,handler(e){if(e){const t=e.slice(0,e.lastIndexOf("/"))||"/";this.currentPath!==t&&this.load(t)}}}},created(){this.load(this.currentPath)},methods:{onCellClick(e,t,a,r){t.property==="name"&&(e.type==="dir"?this.load(e.path):e.type==="file"&&!this.disabled&&this.checkMode==="single"&&this.$emit("update:modelValue",e.path))},onSelectionChange(){},load(e){this.loading=!0,this.loader(e).then(t=>{this.tableData=[...t].sort((a,r)=>{const n=a.type.localeCompare(r.type);return n!==0?n:a.name.localeCompare(r.name)}),e!=="/"&&this.tableData.unshift({type:"dir",name:"..",path:e.slice(0,e.slice(0,e.length-1).lastIndexOf("/"))||"/"}),this.currentPath=e}).finally(()=>{this.loading=!1})},loader(){throw new Error("loader需实现")}}};function S(e,t,a,r,n,u){const y=o("LoadingIcon"),m=o("el-table-column"),g=o("el-radio"),b=o("el-radio-group"),C=o("el-switch"),k=o("el-table");return d(),s(k,{border:"",data:u.filterTableData,style:{width:"100%"},onCellClick:u.onCellClick,onSelectionChange:u.onSelectionChange},V({default:i(()=>[!a.disabled&&a.checkMode==="multiple"?(d(),s(m,{key:0,type:"selection",selectable:l=>l.type==="file"},null,8,["selectable"])):h("",!0),!a.disabled&&a.checkMode==="single"?(d(),s(m,{key:1,width:"40px"},{default:i(l=>[l.row.path===a.modelValue?(d(),s(b,{key:0,"model-value":l.row.path},{default:i(()=>[c(g,{value:l.row.path},null,8,["value"])]),_:2},1032,["model-value"])):h("",!0)]),_:1})):h("",!0),c(m,{"class-name":"filename-cell","show-overflow-tooltip":"",prop:"name",label:"文件名"},{header:i(()=>[t[1]||(t[1]=x(" 文件名 ")),c(C,{modelValue:n.useFileFilter,"onUpdate:modelValue":t[0]||(t[0]=l=>n.useFileFilter=l),"active-text":"打开文件过滤"},null,8,["modelValue"])]),default:i(l=>[f("span",null,p(l.row.type==="dir"?"📁":"📄")+p(l.row.name),1)]),_:1})]),_:2},[n.loading?{name:"empty",fn:i(()=>[f("div",null,[c(y)])]),key:"0"}:void 0]),1032,["data","onCellClick","onSelectionChange"])}const D=_(v,[["render",S]]),B={extends:D,methods:{loader(e){return F(e).then(t=>t.children)},fileFilter(e){return["mkv","mp4","mov"].includes(e.extname)}}},M=_(B,[["__scopeId","data-v-fbd94c47"]]);export{M};

import{_ as N,r as m,ao as D,v as E,ap as O,b as g,p as b,f as o,t as i,w as y,j as u,k as f,F as h,E as S,d as k,l as U,e as j}from"./assets/index-C-zynpsY.js";/* empty css         *//* empty css         *//* empty css         */import{P as x}from"./xIFwcGcH-.js";import{E as H,a as B,b as F,c as T}from"./xBIB-SAPS.js";import{d as Y}from"./xDSpHJm7g.js";import"./xKCnAly9-.js";import"./xBfQpE37G.js";import"./xBOlBa5AA.js";import"./xCZZpmqY5.js";import"./vander_baseFindIndex-D7XfJLKM.js";import"./vander_baseIteratee-CRRCU4B3.js";import"./xBmb3w95w.js";import"./vander_commonjsHelpers-CqkleIqs.js";const M={components:{PageHeader:x,ElCollapse:H,ElCollapseItem:B,ElSelect:F,ElOption:T},setup(){const a=m(0),e=m([]),c=m([]),n=m([{type:"input",label:"IP地址",prop:"clientAddress",tableProps:{width:130}},{type:"input",label:"自生成ID",prop:"massUUID",tableProps:{width:130,formatter:(r,l,t)=>(t==null?void 0:t.slice(0,4))||t}},{type:"input",label:"最后使用时间",prop:"ts",tableProps:{width:160,formatter:(r,l,t)=>Y(t).format("YYYY-MM-DD HH:mm:ss")}},{type:"input",label:"UA",prop:"userAgent",tableProps:{minWidth:130,showOverflowTooltip:!0}}]);return D().then(r=>{a.value=r.length,c.value=r,e.value=c.value.filter(l=>l.accessInfo.some(t=>t.requestInfo.url==="/user/knock")).sort((l,t)=>{var d,_,v,I;return new Date((_=(d=t.accessInfo)==null?void 0:d[0])==null?void 0:_.date).valueOf()-new Date((I=(v=l.accessInfo)==null?void 0:v[0])==null?void 0:I.date).valueOf()}).map(l=>({...l,fingerprintStore:l.fingerprintStore.sort((t,d)=>d.ts-t.ts)})),console.log(e.value)}),{历史客户端数:a,历史有效访客:e,data:c,activeNames:m(""),fingerprintStoreFields:n}},methods:{getClientName(a){var r,l,t;const e=(r=a.accessInfo[0].requestClientInfo.clientAddress)==null?void 0:r.ipInfo,c=((l=a.tags)==null?void 0:l.length)>0?`[${a.tags.join(",")}]`:"";let n=`[${E(a.accessInfo[0].date)}]${c} `;return e&&(n+=`(${Array.from(new Set([e.countryCode])).join("|")})`),n+=(t=a.accessInfo[0].requestClientInfo.clientAddress)==null?void 0:t.address,n},updateTags(a){O(a.uuid,{tags:a.tags.join(",")})}}},G={class:"page"},L={class:"item"},W={class:"item"},$={class:"label-value"},z={class:"value"},J={class:"label-value"},K={class:"value"},Q={class:"label-value"},R={class:"value"},X={class:"label-value"},Z={class:"value"};function ee(a,e,c,n,r,l){const t=u("PageHeader"),d=u("el-option"),_=u("el-select"),v=u("easy-table"),I=u("el-collapse-item"),q=u("el-collapse");return f(),g("div",G,[b(t),o("div",L," 历史访客数："+i(n.历史客户端数),1),o("div",W," 历史有效访客数："+i(n.历史有效访客.length),1),b(q,{modelValue:n.activeNames,"onUpdate:modelValue":e[0]||(e[0]=s=>n.activeNames=s)},{default:y(()=>[(f(!0),g(h,null,S(n.历史有效访客,s=>(f(),k(I,{key:s.fingerprintStore[0].hash,title:"Consistency",name:s.fingerprintStore[0].hash},{title:y(()=>[U(i(l.getClientName(s)),1)]),default:y(()=>{var C,A,w,V,P;return[o("div",null,i(s.accessInfo[0].requestClientInfo.userAgent),1),(C=s.accessInfo[0].requestClientInfo.clientAddress)!=null&&C.ipInfo?(f(),g(h,{key:0},[o("div",$,[e[1]||(e[1]=o("div",{class:"label"}," country: ",-1)),o("div",z,i((A=s.accessInfo[0].requestClientInfo.clientAddress)==null?void 0:A.ipInfo.country),1)]),o("div",J,[e[2]||(e[2]=o("div",{class:"label"}," province: ",-1)),o("div",K,i((w=s.accessInfo[0].requestClientInfo.clientAddress)==null?void 0:w.ipInfo.province),1)]),o("div",Q,[e[3]||(e[3]=o("div",{class:"label"}," city: ",-1)),o("div",R,i((V=s.accessInfo[0].requestClientInfo.clientAddress)==null?void 0:V.ipInfo.city),1)]),o("div",X,[e[4]||(e[4]=o("div",{class:"label"}," isp: ",-1)),o("div",Z,i((P=s.accessInfo[0].requestClientInfo.clientAddress)==null?void 0:P.ipInfo.isp),1)])],64)):j("",!0),b(_,{modelValue:s.tags,"onUpdate:modelValue":p=>s.tags=p,clearable:"",multiple:"",filterable:"",allowCreate:"",placeholder:"标签",onChange:p=>l.updateTags(s)},{default:y(()=>[(f(!0),g(h,null,S(s.tags,p=>(f(),k(d,{key:p,label:p,value:p},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),b(v,{modelValue:s.fingerprintStore,fields:n.fingerprintStoreFields},null,8,["modelValue","fields"])]}),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])])}const ve=N(M,[["render",ee],["__scopeId","data-v-b928d9c2"]]);export{ve as default};

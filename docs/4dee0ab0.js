import{_ as b,A as y,aO as u,aK as m,ay as _,aN as V,b as k,d as n,e as l,p as w,w as g,l as v,h as i,F as p,E as f,f as C,t as S,n as L}from"./assets/index-306e3e3a.js";const x={components:{AsyncButtom:y},props:{modelValue:{type:String,default:()=>"00:00:00"},sourcePath:{type:String,default:()=>""}},emits:["update:modelValue"],data(){return{images:[],timeControllers:[{label:"-1m",value:-60},{label:"-10s",value:-10},{label:"-1s",value:-1},{label:"+1s",value:1},{label:"+10s",value:10},{label:"+1m",value:60}]}},methods:{updateTimestring(s){this.$emit("update:modelValue",`${u(m(this.modelValue.split(".")[0])+s)}.${this.modelValue.split(".")[1]}`)},async refreshScreenshots(s){if(!this.sourcePath){this.$msgBox.warning("请先选择视频源");return}for(const a of this.images)a.originSrc&&URL.revokeObjectURL(a.originSrc),URL.revokeObjectURL(a.src);this.images=[{ts:this.modelValue,src:await this.getScreenshots(this.modelValue,s)}];const r=m(this.modelValue),t=u(_.subtract(r,.1),!0);this.images.unshift({ts:t,src:await this.getScreenshots(t,s)});for(const a in new Array(3).fill(null)){const o=u(_.add(r,(Number(a)+1)*.1),!0);this.images.push({ts:o,src:await this.getScreenshots(o,s)})}},getScreenshots(s,r){return V(this.sourcePath,s,r).then(t=>URL.createObjectURL(t))},reset(){this.images=[]}}},P={class:"preview-screenshots"},B={class:"screenshots-box"},N={class:"btn-box"},R={class:"image-box"},T={class:"ts"},U=["src","onClick"];function A(s,r,t,a,o,c){const d=k("AsyncButtom");return n(),l("div",P,[w(d,{type:"primary",size:"mini",onLoadingClick:()=>c.refreshScreenshots("jpg")},{default:g(()=>r[0]||(r[0]=[v(" 获取截图 ")])),_:1},8,["onLoadingClick"]),i("div",B,[i("div",N,[(n(!0),l(p,null,f(o.timeControllers,e=>(n(),C(d,{key:e.label,size:"mini",onLoadingClick:()=>{c.updateTimestring(e.value)}},{default:g(()=>[v(S(e.label),1)]),_:2},1032,["onLoadingClick"]))),128))]),i("div",R,[(n(!0),l(p,null,f(o.images,e=>(n(),l("div",{key:e.src,class:L(["item-box",{active:e.ts===t.modelValue}])},[i("div",T,S(e.ts),1),i("img",{class:"image",src:e.src,onClick:()=>{e.ts===t.modelValue?s.$imagePreview(()=>e.originSrc?e.originSrc:c.getScreenshots(e.ts,"png").then(h=>(e.originSrc=h,h)),{fileName:t.sourcePath.slice(t.sourcePath.lastIndexOf("/")+1).split(".")[0]}):s.$emit("update:modelValue",e.ts)}},null,8,U)],2))),128))])])])}const j=b(x,[["render",A],["__scopeId","data-v-825dac66"]]);export{j as P};

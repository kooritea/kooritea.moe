const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./xBropTikD.js","./assets/index-B8N2NFTS.js","./assets/index-B3En25Pu.css","./xktA0M0Cd.js","./xDIPPNi1_.js","./xDSpHJm7g.js","./vander_commonjsHelpers-CqkleIqs.js","./xDf6KK1vf.js","./xCwwcDR4w.js","./xUfRJvDvS.js","./xDpnyD6Li.js","./xDAB-g1I0.js","./vander_baseFindIndex-D7XfJLKM.js","./assets/PreviewScreenshots-B76jYR2H.css","./assets/el-scrollbar-BWxh-h6K.css","./assets/el-popper-DG5wR-qi.css","./xDG8vkjHR.js","./x_eWasDQK.js","./assets/MarkDown-BxBGots9.css","./xDUS_OOzP.js","./assets/ImageCon-Ca6gO23F.css","./xDbbNVVyj.js","./xDUAbdKTL.js","./vander_baseIteratee-DTq0dpbl.js","./xD3OlIDDT.js","./xBueOlljh.js","./xDf4a76tW.js","./assets/MDEditor-HcVWVTW2.css","./assets/el-tag-DljBBxJR.css","./assets/el-select-BaQA8IKP.css","./assets/el-date-picker-BUDvp0ks.css"])))=>i.map(i=>d[i]);
import{_ as M,S as x,r as h,j as l,k as a,b as d,m as w,p as E,e as C,n as I,u as S,q as B,s as L,L as b,v as O,f as g,w as k,t as _,d as f,x as P,a as K,y as H,z as V,B as W,C as j,D as U,F as G,E as T,G as q,H as z}from"./assets/index-B8N2NFTS.js";import{P as A}from"./xDyodjcuT.js";import{N as R}from"./xDxoLQxeQ.js";import{M as F}from"./x_eWasDQK.js";/* empty css         *//* empty css         */import{E as J}from"./xDf4a76tW.js";import"./xCwwcDR4w.js";const Q={components:{SvgIcon:x},setup(){return{isSimplifty:h(!1)}},mounted(){this.$el.offsetHeight>600&&(this.isSimplifty=!0)}},X={key:0,class:"simplifty-mask"};function Y(e,t,o,n,u,r){const y=l("SvgIcon");return a(),d("div",{class:I(["simplifty-box",{"is-simplifty":n.isSimplifty}])},[w(e.$slots,"default",{},void 0,!0),n.isSimplifty?(a(),d("div",X,[E(y,{name:"zhankai",class:"expend-button",onClick:t[0]||(t[0]=m=>n.isSimplifty=!1)})])):C("",!0)],2)}const Z=M(Q,[["render",Y],["__scopeId","data-v-7afa2ae9"]]);function D(e,t){const{darkMode:o}=S(),{darkModeDecodeKey:n}=B();return o.value&&(e.hide||t)?e.id?L(e.hide,n.value):e.hide:e.content}const $={components:{Markdown:F,SimpliftyBox:Z,LoadingIcon:b,"el-popover":J},props:{essay:{type:Object,required:!0},essayMap:{type:Object,required:!0},inPopover:{type:Boolean,default:!1}},emits:["set-search-key-word","load-essay-by-id"],setup(){const{darkMode:e}=S();return{darkMode:e,formatDate:O,Error}},methods:{getEssayContent:D}},ee={class:"essay"},se={key:0,class:"unsafe-content"},te=["onClick"],ne={class:"hashtag"},oe={key:0,class:"loading-box"},ae={key:1},ie={class:"info"},re={class:"essay-id"};function le(e,t,o,n,u,r){const y=l("LoadingIcon"),m=l("ChaosItem",!0),v=l("el-popover"),p=l("Markdown"),c=l("SimpliftyBox");return a(),d("div",ee,[g("article",{class:I(["article",{"in-popover":o.inPopover}])},[E(c,null,{default:k(()=>[o.essay.unsafe?(a(),d("div",se,_(o.essay.content),1)):(a(),f(p,{key:1,"model-value":r.getEssayContent(o.essay)},{hashtag:k(({hashtag:s})=>[!/^#\d+$/.test(s)||o.inPopover?(a(),d("span",{key:0,class:"hashtag",onClick:i=>e.$emit("set-search-key-word",s)},_(s),9,te)):(a(),f(v,{key:1,width:"",trigger:"click","popper-class":"popper-essay",effect:n.darkMode?"dark":"light",onShow:()=>{o.essayMap[s.slice(1)]||e.$emit("load-essay-by-id",s.slice(1))}},{reference:k(()=>[g("span",ne,_(s),1)]),default:k(()=>[!o.essayMap[s.slice(1)]||o.essayMap[s.slice(1)]instanceof Error?(a(),d("div",oe,[o.essayMap[s.slice(1)]?(a(),d("span",ae,_(o.essayMap[s.slice(1)].message),1)):(a(),f(y,{key:0}))])):(a(),f(m,{key:1,essay:o.essayMap[s.slice(1)],"essay-map":o.essayMap,"in-popover":!0,onSetSearchKeyWord:t[0]||(t[0]=i=>{e.$emit("set-search-key-word",i)})},null,8,["essay","essay-map"]))]),_:2},1032,["effect","onShow"]))]),_:1},8,["model-value"]))]),_:1})],2),g("div",ie,[g("span",re,"#"+_(o.essay.id||"预约中"),1),g("span",null,_(n.formatDate(o.essay.time,`yyyy-MM-dd HH:mm:ss UTC ${n.darkMode?"NDD":"DD"}`)),1)])])}const de=M($,[["render",le],["__scopeId","data-v-1f32201e"]]),ce={components:{ChaosItem:de,PageHeader:A,NextButton:R,SvgIcon:x,MDEditor:P({loader:()=>z(()=>import("./xBropTikD.js").then(e=>e.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]),import.meta.url),loadingComponent:b})},setup(){const e=h({}),{darkMode:t,isGreatOldOne:o}=S(),{offlineMode:n}=B(),u=h(""),r=K([]),y=h(!1),m=h(!1),v=h(null),p=c=>(m.value=!0,q(c).then(s=>{s=s.map(i=>(e.value[i.id]=i,{...i,expend:!1})),y.value=s.length===10,r.push(...s)}).finally(()=>{m.value=!1}));return p(),o.value&&H().then(c=>{c=c.sort((s,i)=>new Date(s.time).valueOf()-new Date(i.time).valueOf());for(const s of c)r.unshift(s)}),{loading:m,searchBlogEssays:p,essays:r,searchKeyWord:u,offlineMode:n,hasNext:y,darkMode:t,essayMap:e,setScorllGotoTop:V,isGreatOldOne:o,editing:v}},methods:{getEssayContent:D,search(e){if(this.essays.splice(0,this.essays.length),this.offlineMode&&e&&!/^#\d+$/.test(e)){this.$msgBox.error("离线模式下仅可以使用id搜索");return}return this.searchBlogEssays({keyword:e})},onNext(){var t;const e=(t=this.essays[this.essays.length-1])==null?void 0:t.id;return this.searchBlogEssays({keyword:this.searchKeyWord,start:e?e-1:void 0})},loadEssayById(e){if(this.essayMap[e]!==null)return this.essayMap[e]=null,W({id:e}).then(t=>{this.essayMap[e]=t}).catch(t=>{this.essayMap[e]=new Error(t)})},onSubmitUpdateEssay(e,t,o,n){if(e.id)return j(e.id,{content:t?void 0:o,hide:t?o||null:void 0}).then(u=>{Object.assign(e,u),this.editing=null});if(e.uuid)return U(e.uuid,{content:t?void 0:o,hide:t?o||null:void 0,time:n}).then(u=>{Object.assign(e,u),this.editing=null})}}},ue={class:"page"};function ye(e,t,o,n,u,r){const y=l("PageHeader"),m=l("ChaosItem"),v=l("MDEditor"),p=l("SvgIcon"),c=l("NextButton");return a(),d("div",ue,[E(y,{modelValue:n.searchKeyWord,"onUpdate:modelValue":t[0]||(t[0]=s=>n.searchKeyWord=s),"show-search-input":!0,"on-input":r.search},null,8,["modelValue","on-input"]),g("ul",null,[(a(!0),d(G,null,T(n.essays,s=>(a(),d("li",{key:s.id,class:"essay-box"},[n.editing!==s?(a(),f(m,{key:0,essay:s,"essay-map":n.essayMap,onSetSearchKeyWord:t[1]||(t[1]=i=>{n.searchKeyWord=i,n.setScorllGotoTop()}),onLoadEssayById:r.loadEssayById},null,8,["essay","essay-map","onLoadEssayById"])):(a(),f(v,{key:1,"model-value":r.getEssayContent(s,!0),cache:!1,"ex-handlers":[{name:"取消",handler:()=>{n.editing=null}}],"on-submit":(i,N)=>r.onSubmitUpdateEssay(s,n.darkMode,i,N)},null,8,["model-value","ex-handlers","on-submit"])),n.isGreatOldOne&&n.editing!==s?(a(),f(p,{key:2,name:"bianji",onClick:i=>n.editing=s},null,8,["onClick"])):C("",!0)]))),128))]),E(c,{hasNext:n.hasNext,"onUpdate:hasNext":t[2]||(t[2]=s=>n.hasNext=s),loading:n.loading,"onUpdate:loading":t[3]||(t[3]=s=>n.loading=s),onLoadingClick:r.onNext},null,8,["hasNext","loading","onLoadingClick"])])}const Ee=M(ce,[["render",ye],["__scopeId","data-v-404cc5a1"]]);export{Ee as default};

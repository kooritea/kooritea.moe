const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./xBNhcnTJZ.js","./assets/index-bTCCQilh.js","./assets/index-DammkxUV.css","./xUOK5AFc_.js","./xBzOXdNh4.js","./xDSpHJm7g.js","./vander_commonjsHelpers-CqkleIqs.js","./xDeXC3GQM.js","./x-58YQu8W.js","./xCQcsltwh.js","./xCNvbZMHK.js","./xDXKCFEsk.js","./vander_baseFindIndex-D7XfJLKM.js","./assets/PreviewScreenshots-B76jYR2H.css","./assets/el-scrollbar-BWxh-h6K.css","./assets/el-popper-DG5wR-qi.css","./xDuRfK-6F.js","./xBZ4DUl8i.js","./assets/MarkDown-BhWfQBYh.css","./xDppW-6v2.js","./assets/ImageCon-lsCsi0ah.css","./xU5a7zuaJ.js","./xBxC-smV4.js","./vander_baseIteratee-Blc6yE_e.js","./xCp8nBs_8.js","./xCWkh9H3y.js","./xZyng51DG.js","./assets/MDEditor-DDUK1HC6.css","./assets/el-tag-DljBBxJR.css","./assets/el-select-BaQA8IKP.css","./assets/el-date-picker-BUDvp0ks.css"])))=>i.map(i=>d[i]);
import{_ as E,S as T,m as D,u as P,p as V,r as u,a as C,E as G,G as L,s as O,H as W,b as y,z as l,w as k,f as h,F as b,B as I,I as K,j as c,k as d,l as S,t as x,d as N,e as U,J as j,D as H,L as R}from"./assets/index-bTCCQilh.js";import{P as A}from"./xCGzxTDAw.js";import{N as F}from"./xPAKvvFOB.js";import{M as Q}from"./xBZ4DUl8i.js";import{C as X}from"./x7e2SMlb6.js";/* empty css         *//* empty css         */import{E as z}from"./xZyng51DG.js";import"./x-58YQu8W.js";const J={components:{ElPopover:z,ChaosItem:X,Markdown:Q,PageHeader:A,NextButton:F,SvgIcon:T,MDEditor:D({loader:()=>H(()=>import("./xBNhcnTJZ.js").then(n=>n.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30]),import.meta.url),loadingComponent:R})},setup(){const{darkMode:n,isGreatOldOne:o}=P(),{offlineMode:p}=V(),e=u(""),w=C([]),m=C({}),a=u("all"),g=u(!1),f=u(!1),M=u(null),_=u(""),v=r=>(f.value=!0,K(r).then(i=>{i=i.map(t=>({...t,content:t.content.replace(/\[music\-card/g,"[music"),id:`${t.author}-${t.id}`,mid:t.id,time:t.date,expend:!1,link:{leoon:"https://www.leoon.cn/moment",gofixpro:"https://blog.gofixpro.fun/",dnick:"https://dnick.cn/",GrayfenXie:"https://www.grayfen.cn/",baymax:"https://ys.xjinfeng.top/essays",yuanmoc:"https://www.yuanmoc.cn/daily/"}[t.author]})),g.value=i.length===10,w.push(...i)}).finally(()=>{f.value=!1}));return v(),G().then(r=>{_.value=r,console.log(_)}),L(a,()=>{if(!m[a.value]){const r=a.value;j(r).then(i=>{m[r]=i})}},{immediate:!0}),{loading:f,searchBlogmoments:v,moments:w,statistics:m,statisticsType:a,searchKeyWord:e,offlineMode:p,hasNext:g,darkMode:n,setScorllGotoTop:O,isGreatOldOne:o,editing:M,weekReport:_}},methods:{search(n){if(this.moments.splice(0,this.moments.length),this.offlineMode&&n&&!/^#\d+$/.test(n)){this.$msgBox.error("离线模式下仅可以使用id搜索");return}return this.searchBlogmoments({keyword:n})},onNext(){var o;const n=(o=this.moments[this.moments.length-1])==null?void 0:o.mid;return this.searchBlogmoments({keyword:this.searchKeyWord,start:n?n-1:void 0})},onSubmitUpdatemoment(n,o,p){if(n.mid)return W(n.mid,{content:o?void 0:p,hide:o?p||null:void 0}).then(e=>{Object.assign(n,e),this.editing=null})}}},q={class:"page"},Y={class:"title"},Z={class:"rank-box"},$={class:"author"},ee={class:"count"};function te(n,o,p,e,w,m){const a=c("svg-icon"),g=c("el-popover"),f=c("Markdown"),M=c("PageHeader"),_=c("ChaosItem"),v=c("MDEditor"),r=c("SvgIcon"),i=c("NextButton");return d(),y("div",q,[l(M,{modelValue:e.searchKeyWord,"onUpdate:modelValue":o[1]||(o[1]=t=>e.searchKeyWord=t),"show-search-input":!0,"on-input":m.search},{title:k(({title:t})=>[h("div",Y,[S(x(t)+" ",1),l(g,{width:"",trigger:"click","popper-class":"popper-essay",effect:e.darkMode?"dark":"light"},{reference:k(()=>[l(a,{name:"rank"})]),default:k(()=>[h("div",Z,[h("div",{class:"name",onClick:o[0]||(o[0]=()=>{const s=["all","year","month","week","today"],B=s.indexOf(e.statisticsType);e.statisticsType=s[B===s.length-1?0:B+1]})},[S(x({all:"历史总榜",year:"年榜",month:"月榜",week:"周榜",today:"日榜"}[e.statisticsType])+" ",1),l(a,{name:"switch"})]),(d(!0),y(b,null,I(e.statistics[e.statisticsType]||[],s=>(d(),y("div",{key:s.author,class:"rank"},[h("span",$,x(s.author),1),h("span",ee,x(s.count),1)]))),128))])]),_:1},8,["effect"]),l(g,{width:"",trigger:"click","popper-class":"popper-essay",effect:e.darkMode?"dark":"light"},{reference:k(()=>[l(a,{name:"report"})]),default:k(()=>[l(f,{"model-value":e.weekReport,safeMode:!0},null,8,["model-value"])]),_:1},8,["effect"])])]),_:1},8,["modelValue","on-input"]),h("ul",null,[(d(!0),y(b,null,I(e.moments,t=>(d(),y("li",{key:t.mid,class:"moment-box"},[e.editing!==t?(d(),N(_,{key:0,essay:t,isMarkDowm:["leoon","dnick","GrayfenXie","gofixpro"].includes(t.author),safeMode:!0,hasComment:!0,commentQuery:s=>({momentId:s.mid}),onSetSearchKeyWord:o[2]||(o[2]=s=>{e.searchKeyWord=s,e.setScorllGotoTop()})},null,8,["essay","isMarkDowm","commentQuery"])):(d(),N(v,{key:1,"model-value":t.content,cache:!1,"ex-handlers":[{name:"取消",handler:()=>{e.editing=null}}],"on-submit":s=>m.onSubmitUpdatemoment(t,e.darkMode,s)},null,8,["model-value","ex-handlers","on-submit"])),e.isGreatOldOne&&e.editing!==t?(d(),N(r,{key:2,name:"bianji",onClick:s=>e.editing=t},null,8,["onClick"])):U("",!0)]))),128))]),l(i,{hasNext:e.hasNext,"onUpdate:hasNext":o[3]||(o[3]=t=>e.hasNext=t),loading:e.loading,"onUpdate:loading":o[4]||(o[4]=t=>e.loading=t),onLoadingClick:m.onNext},null,8,["hasNext","loading","onLoadingClick"])])}const me=E(J,[["render",te],["__scopeId","data-v-bb5fe971"]]);export{me as default};

import{_ as m,u as h,a5 as c,av as f,aw as M,ax as _,ay as P,az as w,aA as y,aB as C,b as g,z as s,w as l,j as n,k as E,f as x,l as T}from"./assets/index-DCkEgMdT.js";import{P as F}from"./xChi37_To.js";const I={components:{PageHeader:F},setup(){const{mobileMode:e}=h();return{mobileMode:e}},data(){return{isExSearch:!1,OneMetaCodeMap:[],GroupMetaCodeMap:[],tableData:[],tableProp:{tableConfig:{handlerWidth:"210px",showPagination:!0,tableProps:{stripe:!0,border:!0},tableHandlerProps:{fixed:void 0},publicTableProps:{showOverflowTooltip:!0},tableSelectionProps:{selectable:e=>!!e.filepath}},emitLoadOnCreate:!0,buttons:[{type:"primary",buttonProps:{link:!0},label:"编辑",handler:(e,t)=>{this.$refs.EditTable.editReady(t.row)}},{type:"danger",buttonProps:{link:!0},show:(e,t)=>this.GroupMetaCodeMap.includes(t.row.code),label:"删除",handler:(e,t)=>{c({title:"提示",message:`确认删除${t.row.code}:${t.row.value}`,type:"warning",confirmHandlerPromise:()=>f(t.row.id).then(()=>this.$refs.EditTable.search())})}}]},searchFormProp:{formConfig:{labelWidth:"100px",labelPosition:"right",gutter:32}},formProp:{formConfig:{labelPosition:"top",selectEditMode:e=>!e.formData._isAdd,buttonPosition:"right"},buttons:[{type:"primary",label:"提交",handler:(e,t,o)=>e.formInstance.submitForm({fieldOnly:!0}).then(a=>e.formData._isAdd?(a.label||delete a.label,M(a).then(r=>(this.$refs.EditTable.editConfirm(r),this.$refs.EditTable.search()))):_(e.formData.id,a).then(r=>{this.$refs.EditTable.editConfirm(r)}))}]},fields:[{type:"select",label:"代号",prop:"code",required:e=>e.meta.isForm,options:e=>e.meta.isSearchForm?[...this.OneMetaCodeMap,...this.GroupMetaCodeMap]:this.GroupMetaCodeMap,span:12,showInForm:!0,isView:e=>e.meta.isForm&&!e.formData._isAdd},{type:"MDEditor",prop:"value",label:"值",required:!0,showInForm:e=>!!e.meta.isForm},{type:"textarea",prop:"label",label:"描述",showInForm:e=>!!e.meta.isForm},{type:"buttons",showInTable:!1,showInForm:e=>e.meta.isSearchForm===!0,hiddenLabel:!0,label:"搜索操作",prop:"搜索操作",span:6,formItemProp:{labelWidth:"0px"},buttons:[{label:e=>this.isExSearch?"收起":"展开",leftIcon:e=>this.isExSearch?P:w,type:"primary",buttonProps:{link:!0},handler:e=>{this.isExSearch=!this.isExSearch}},{label:"查询",type:"primary",handler:e=>{const{meta:t}=e,{_editTable:o}=t,{editTableInstance:a}=o;a.search()}},{label:"重置",type:"primary",buttonProps:{plain:!0},handler:e=>{const{meta:t}=e,{_editTable:o}=t,{editTableInstance:a}=o;a.search({reset:!0})}}]}]}},created(){y().then(e=>{this.OneMetaCodeMap=e.OneMetaCodeMap,this.GroupMetaCodeMap=e.GroupMetaCodeMap})},methods:{onLoad(e,t){return C({size:e.size,page:e.current,andEqual:t}).then(o=>({tableData:o.records,total:o.total}))}}},O={class:"page"},v={class:"table-top"};function G(e,t,o,a,r,i){const p=n("PageHeader"),d=n("el-button"),u=n("edit-table");return E(),g("div",O,[s(p),s(u,{ref:"EditTable",modelValue:r.tableData,"onUpdate:modelValue":t[1]||(t[1]=b=>r.tableData=b),"show-search-form":!0,fields:r.fields,"table-prop":r.tableProp,"search-form-prop":r.searchFormProp,"form-prop":r.formProp,"search-loader":i.onLoad},{"table-top":l(()=>[x("div",v,[s(d,{type:"primary",onClick:t[0]||(t[0]=()=>{e.$refs.EditTable.editReady({})})},{default:l(()=>t[2]||(t[2]=[T(" 添加 ")])),_:1})])]),_:1},8,["modelValue","fields","table-prop","search-form-prop","form-prop","search-loader"])])}const A=m(I,[["render",G],["__scopeId","data-v-ef1e3840"]]);export{A as default};

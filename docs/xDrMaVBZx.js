import{_ as w,A as L,aL as c,aM as g,az as f,aP as C,k as n,b as i,p as m,f as a,w as v,l as b,F as V,E as _,d as P,t as S,n as x,j as d}from"./assets/index-BCg_aInO.js";/* empty css         *//* empty css         */import{a as B,E as U}from"./xBOC637hL.js";const N={components:{AsyncButtom:L,ElTimePicker:B,ElInputNumber:U},props:{modelValue:{type:String,default:()=>"00:00:00.0"},sourcePath:{type:String,default:()=>""},sourceKeyname:{type:String,default:()=>""}},emits:["update:modelValue"],data(){return{images:[],timeControllers:[{label:"-1m",value:-60},{label:"-10s",value:-10},{label:"-1s",value:-1},{label:"+1s",value:1},{label:"+10s",value:10},{label:"+1m",value:60}]}},methods:{updateTimestring(l){this.$emit("update:modelValue",`${c(g(this.modelValue.split(".")[0])+l)}.${this.modelValue.split(".")[1]}`)},async refreshScreenshots(l){if(!this.sourcePath&&!this.sourceKeyname){this.$msgBox.warning("请先选择视频源");return}for(const o of this.images)o.originSrc&&URL.revokeObjectURL(o.originSrc),URL.revokeObjectURL(o.src);this.images=[{ts:this.modelValue,src:await this.getScreenshots(this.modelValue,l)}];const t=g(this.modelValue),s=c(f.subtract(t,.1),!0);this.images.unshift({ts:s,src:await this.getScreenshots(s,l)});for(const o in new Array(3).fill(null)){const r=c(f.add(t,(Number(o)+1)*.1),!0);this.images.push({ts:r,src:await this.getScreenshots(r,l)})}},getScreenshots(l,t){return C({sourcePath:this.sourcePath,sourceKeyname:this.sourceKeyname,timestamps:l,format:t}).then(s=>URL.createObjectURL(s))}}},T={class:"preview-screenshots"},R={class:"screenshots-box"},j={class:"btn-box"},A={class:"image-box"},E={class:"ts"},z=["src","onClick"];function H(l,t,s,o,r,u){const y=d("el-time-picker"),k=d("el-input-number"),h=d("AsyncButtom");return n(),i("div",T,[m(y,{"model-value":s.modelValue.split(".")[0],"value-format":"HH:mm:ss",format:"HH:mm:ss",style:{width:"120px"},"onUpdate:modelValue":t[0]||(t[0]=e=>{l.$emit("update:modelValue",`${e||"00:00:00"}.${s.modelValue.split(".")[1]}`)})},null,8,["model-value"]),t[3]||(t[3]=a("span",null,".",-1)),m(k,{"model-value":+("0."+(s.modelValue.split(".")[1]||"0")),min:0,max:1,precision:3,step:.1,style:{width:"120px"},"onUpdate:modelValue":t[1]||(t[1]=e=>{l.$emit("update:modelValue",`${s.modelValue.split(".")[0]}.${String(e).split(".")[1]||0}`)})},null,8,["model-value"]),m(h,{type:"primary",size:"mini",onLoadingClick:()=>u.refreshScreenshots("jpg")},{default:v(()=>t[2]||(t[2]=[b(" 获取截图 ")])),_:1},8,["onLoadingClick"]),a("div",R,[a("div",j,[(n(!0),i(V,null,_(r.timeControllers,e=>(n(),P(h,{key:e.label,size:"mini",onLoadingClick:()=>{u.updateTimestring(e.value)}},{default:v(()=>[b(S(e.label),1)]),_:2},1032,["onLoadingClick"]))),128))]),a("div",A,[(n(!0),i(V,null,_(r.images,e=>(n(),i("div",{key:e.src,class:x(["item-box",{active:e.ts===s.modelValue}])},[a("div",E,S(e.ts),1),a("img",{class:"image",src:e.src,onClick:()=>{e.ts===s.modelValue?l.$imagePreview(()=>e.originSrc?e.originSrc:u.getScreenshots(e.ts,"png").then(p=>(e.originSrc=p,p)),{fileName:s.sourcePath.slice(s.sourcePath.lastIndexOf("/")+1).split(".")[0]}):l.$emit("update:modelValue",e.ts)}},null,8,z)],2))),128))])])])}const F=w(N,[["render",H],["__scopeId","data-v-90a835a7"]]);export{F as P};
